# Bitbank - Relay

(c) 2021-2022 Bernd Fix <brf@hoi-polloi.org>   >Y<

bitbank-relay is free software: you can redistribute it and/or modify it
under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License,
or (at your option) any later version.

bitbank-relay is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

SPDX-License-Identifier: AGPL3.0-or-later

# Running the database management program

The database program `bitbank-relay-db` is used to manage the relay database
and to provide a management GUI for administration:

```bash
bitbank-relay-db [-c <config file>] <cmd> [arguments & options]
```

The option `-c` is used to specify the configuration file to be used (defaults
to `config.json` in the current working directory).

The following commands are implemented:

## command `gui`

This command starts a web service; use a web browser to work with the management
GUI provided by the service. The `gui` command has the following options:

* **`-l <host:port>`**: starts the web service on given port on given host. Use
`0.0.0.0` for host to allow all IPs to connect to the service

* **`-p <prefix>`**: Prefix to be prepended to all URLs generated by the service.
This option is required if the web service is running behind a reverse proxy (e.g.
nginx) on a path (and not in document root).

## command `logo`

The `logo` command is used to add one or multipe coin logos to the database (see
separate [README](https://github.com/bfix/bitbank-relay/tree/master/deployment)
for more details). The command has the following options:

* **`-i <folder>`**: Import all logos from the given folder
* **`-f <file>`**: Import specific logo from file

Coin logos have to be SVG files (minimized to keep their size smaller than
10kB) and their name must match the coin symbol in the database - otherwise
the import will fail.

## command `report`

The `report` command is used to generate reports about incoming funds. It has
the following options:

* **`-r <from>:<to>`**: Date range for report (inclusive). The format of a date
  must be `YYYY-MM-DD`
* **`-m <mode>`**: Report mode [`fast` (default),`full`]. A 'fast' report only
  uses entries from the `incoming` database table which might contain no or
  unprecise entries regarding the time funds are received. A ' full'  report
  will use a blockchain service to resolve all transactions for incoming funds
  with exact timestamps.
* **`-a <address>`**: Only include given address in the report
* **`-c <coin>`**: Only include given coin in the report
* **`-p <account>`**: Only include given account in the report
* **`-o <format>`**: Output format [`csv` (default),`json`]
* **`-f <file>`**: Output file (defaults to `report.txt`)

# Database maintenance

(to be described)
